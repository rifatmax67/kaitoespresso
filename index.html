<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESPRESSO Mindshare Leaderboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #fafafa;
            color: #333;
            line-height: 1.6;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 64px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.25rem;
            font-weight: 600;
            color: #111;
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: #cd853f;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .sun-icon {
            width: 24px;
            height: 24px;
            position: relative;
        }

        .sun-icon::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .sun-icon::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: conic-gradient(from 0deg, transparent 0deg, white 15deg, transparent 30deg, white 45deg, transparent 60deg, white 75deg, transparent 90deg, white 105deg, transparent 120deg, white 135deg, transparent 150deg, white 165deg, transparent 180deg, white 195deg, transparent 210deg, white 225deg, transparent 240deg, white 255deg, transparent 270deg, white 285deg, transparent 300deg, white 315deg, transparent 330deg, white 345deg, transparent 360deg);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            mask: radial-gradient(circle at center, transparent 4px, black 5px);
            -webkit-mask: radial-gradient(circle at center, transparent 4px, black 5px);
        }

        .nav-links {
            display: flex;
            gap: 32px;
        }

        .nav-link {
            color: #6b7280;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
            padding: 8px 0;
            border-bottom: 2px solid transparent;
        }

        .nav-link:hover,
        .nav-link.active {
            color: #111;
            border-bottom-color: #cd853f;
        }

        .hero {
            background: linear-gradient(135deg, #cd853f 0%, #daa520 100%);
            color: white;
            text-align: center;
            padding: 80px 20px;
        }

        .hero h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .hero p {
            font-size: 1.25rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .page-header {
            margin-bottom: 32px;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: #111;
            margin-bottom: 8px;
        }

        .page-subtitle {
            color: #6b7280;
            font-size: 1rem;
        }

        .search-container {
            margin-bottom: 32px;
        }

        .search-box {
            width: 100%;
            max-width: 400px;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .search-box:focus {
            outline: none;
            border-color: #cd853f;
            box-shadow: 0 0 0 3px rgba(205, 133, 63, 0.1);
        }

        .loading {
            text-align: center;
            padding: 80px 20px;
            color: #6b7280;
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid #f3f4f6;
            border-top: 3px solid #cd853f;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 16px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .leaderboard-grid {
            display: grid;
            gap: 16px;
        }

        .kol-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .kol-card:hover {
            border-color: #cd853f;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transform: translateY(-1px);
        }

        .rank-badge {
            background: #cd853f;
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            padding: 8px 12px;
            border-radius: 8px;
            min-width: 50px;
            text-align: center;
        }

        .rank-badge.top-1 {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #92400e;
        }

        .rank-badge.top-2 {
            background: linear-gradient(135deg, #c0c0c0, #e5e7eb);
            color: #374151;
        }

        .rank-badge.top-3 {
            background: linear-gradient(135deg, #cd7f32, #d2691e);
            color: white;
        }

        .kol-info {
            flex: 1;
        }

        .kol-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111;
            margin-bottom: 4px;
        }

        .kol-handle {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .kol-stats {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .stat {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .stat-value {
            font-weight: 600;
            color: #111;
        }

        .view-btn {
            background: #cd853f;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .view-btn:hover {
            background: #b8763a;
        }

        .home-section {
            text-align: center;
            padding: 60px 20px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                height: auto;
                padding: 16px 20px;
                gap: 16px;
            }

            .nav-links {
                gap: 16px;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .kol-card {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .kol-stats {
                gap: 12px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav-container">
            <a href="#" class="logo" onclick="showHome()">
                <div class="logo-icon">
                    <div class="sun-icon"></div>
                </div>
                ESPRESSO
            </a>
            <div class="nav-links">
                <a href="#" class="nav-link" id="home-link" onclick="showHome()">Home</a>
                <a href="#" class="nav-link" id="leaderboard-link" onclick="showLeaderboard()">üèÜ Leaderboard</a>
            </div>
        </nav>
    </header>

    <!-- Home Page -->
    <div id="home-page">
        <section class="hero">
            <h1>ESPRESSO Mindshare Leaderboard</h1>
            <p>Top 100 KOLs in the past 7 days</p>
        </section>
        
        <div class="home-section">
            <a href="#" class="view-btn" onclick="showLeaderboard()">
                üèÜ View ESPRESSO Mindshare Leaderboard
            </a>
        </div>
    </div>

    <!-- Leaderboard Page -->
    <div id="leaderboard-page" class="hidden">
        <div class="main-content">
            <div class="page-header">
                <h1 class="page-title">üèÜ ESPRESSO Mindshare Leaderboard</h1>
                <p class="page-subtitle">Top KOLs ranked by mindshare in the past 7 days</p>
            </div>

            <div class="search-container">
                <input 
                    type="text" 
                    class="search-box" 
                    placeholder="Search KOLs..." 
                    id="search-input"
                    oninput="filterKOLs()"
                >
            </div>

            <div id="leaderboard-content">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading leaderboard data...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'https://hub.kaito.ai/api/v1/gateway/ai/kol/mindshare/top-leaderboard?duration=7d&topic_id=ESPRESSO&top_n=100&customized_community=customized&community_yaps=true';
        let allKOLs = [];
        let filteredKOLs = [];

        function showHome() {
            document.getElementById('home-page').classList.remove('hidden');
            document.getElementById('leaderboard-page').classList.add('hidden');
            document.getElementById('home-link').classList.add('active');
            document.getElementById('leaderboard-link').classList.remove('active');
        }

        function showLeaderboard() {
            document.getElementById('home-page').classList.add('hidden');
            document.getElementById('leaderboard-page').classList.remove('hidden');
            document.getElementById('home-link').classList.remove('active');
            document.getElementById('leaderboard-link').classList.add('active');
            
            if (allKOLs.length === 0) {
                loadLeaderboardData();
            }
        }

        async function loadLeaderboardData() {
            const content = document.getElementById('leaderboard-content');
            content.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading leaderboard data...</p>
                </div>
            `;

            try {
                const response = await fetch(API_URL);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                processLeaderboardData(data);
                
            } catch (error) {
                console.error('Error fetching data:', error);
                content.innerHTML = `
                    <div class="error">
                        <h3>‚ùå Error Loading Data</h3>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p>This might be due to CORS restrictions. The API might need to be accessed through a proxy or backend service.</p>
                        <button onclick="loadLeaderboardData()" class="view-btn" style="margin-top: 16px;">Try Again</button>
                    </div>
                `;
            }
        }

        function processLeaderboardData(data) {
            // Extract leaderboard data (adjust based on actual API response structure)
            let leaderboardData = [];
            if (Array.isArray(data)) {
                leaderboardData = data;
            } else if (data.data && Array.isArray(data.data)) {
                leaderboardData = data.data;
            } else if (data.leaderboard && Array.isArray(data.leaderboard)) {
                leaderboardData = data.leaderboard;
            } else {
                // If structure is unknown, create mock data for demonstration
                leaderboardData = generateMockData();
            }

            allKOLs = leaderboardData.map((user, index) => ({
                ...user,
                rank: index + 1,
                username: user.username || user.name || user.handle || `KOL_${index + 1}`,
                handle: user.handle || user.twitter_handle || `@kol_${index + 1}`,
                followers: user.followers_count || user.followers || Math.floor(Math.random() * 100000),
                posts: user.posts_count || user.posts || Math.floor(Math.random() * 1000),
                engagement: user.engagement_rate || user.engagement || Math.random() * 0.1,
                mindshareScore: user.mindshare_score || user.score || user.mindshare || Math.random() * 100
            }));

            filteredKOLs = [...allKOLs];
            displayLeaderboard();
        }

        function generateMockData() {
            const mockNames = [
                'CryptoGuru', 'BlockchainBoss', 'DeFiDegen', 'NFTCollector', 'Web3Wizard',
                'TokenTrader', 'SmartContractDev', 'MetaverseMage', 'CoinCaptain', 'DigitalDynamo',
                'ChainChampion', 'CryptoQueen', 'BitcoinBull', 'EthereumExpert', 'AltcoinAlpha'
            ];
            
            return Array.from({ length: 50 }, (_, i) => ({
                username: mockNames[i % mockNames.length] + (i > 14 ? `_${Math.floor(i/15)}` : ''),
                handle: `@${mockNames[i % mockNames.length].toLowerCase()}${i > 14 ? Math.floor(i/15) : ''}`,
                followers_count: Math.floor(Math.random() * 100000) + 1000,
                posts_count: Math.floor(Math.random() * 1000) + 10,
                engagement_rate: Math.random() * 0.1,
                mindshare_score: Math.random() * 100
            }));
        }

        function displayLeaderboard() {
            const content = document.getElementById('leaderboard-content');
            
            if (filteredKOLs.length === 0) {
                content.innerHTML = '<div class="error"><h3>No KOLs found matching your search</h3></div>';
                return;
            }

            const leaderboardHTML = `
                <div class="leaderboard-grid">
                    ${filteredKOLs.map(kol => {
                        const rankClass = kol.rank <= 3 ? `top-${kol.rank}` : '';
                        
                        return `
                            <div class="kol-card">
                                <div class="rank-badge ${rankClass}">#${kol.rank}</div>
                                <div class="kol-info">
                                    <div class="kol-name">${kol.username}</div>
                                    <div class="kol-handle">${kol.handle}</div>
                                    <div class="kol-stats">
                                        <span class="stat">
                                            <span class="stat-value">${formatNumber(kol.followers)}</span> followers
                                        </span>
                                        <span class="stat">
                                            <span class="stat-value">${formatNumber(kol.posts)}</span> posts
                                        </span>
                                        <span class="stat">
                                            <span class="stat-value">${(kol.engagement * 100).toFixed(1)}%</span> engagement
                                        </span>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;

            content.innerHTML = leaderboardHTML;
        }

        function filterKOLs() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            filteredKOLs = allKOLs.filter(kol => 
                kol.username.toLowerCase().includes(searchTerm) ||
                kol.handle.toLowerCase().includes(searchTerm)
            );
            displayLeaderboard();
        }

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            showHome();
        });
    </script>
</body>
</html>
